local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")

local specialUsers = {
    ["nin900500"] = "Purple",
    ["Ardwyck"] = "Purple",
    ["0kto"] = "Purple",
    ["Blackrep"] = "Purple",
    ["sillypure"] = "Purple",
    ["RAE181"] = "Purple",
    ["colosae"] = "Purple",
    ["TyrantKDN"] = "Purple",
    ["PartiallyGreen"] = "Purple",
    ["athreose"] = "Purple",
    ["Nickaladormz"] = "Purple",
    ["TimmySavage"] = "Purple",
    ["Ossalac"] = "Purple",
    ["theone78lol"] = "Purple",
    ["PeakDev"] = "Purple",
    ["vinjiso"] = "Purple",
    ["EnamelMammal"] = "Purple",
    ["JohnDrinkin"] = "Purple"
}

local anotherRoleUsers = {
    ["0uxnx"] = "Blue"
}

local function createUI()
    local player = Players.LocalPlayer
    local playerGui = player:WaitForChild("PlayerGui")
    
    local existingGui = playerGui:FindFirstChild("PlayerListGui")
    if existingGui then
        print("UI already exists")
        return existingGui.Frame
    end

    print("Creating UI")
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "PlayerListGui"
    screenGui.Parent = playerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0.2, 0, 0.4, 0)
    frame.Position = UDim2.new(0.8, 0, 1, -10)
    frame.AnchorPoint = Vector2.new(0, 1)
    frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    frame.BorderSizePixel = 2
    frame.BackgroundTransparency = 0.7
    frame.Parent = screenGui

    local uiListLayout = Instance.new("UIListLayout")
    uiListLayout.Parent = frame
    uiListLayout.SortOrder = Enum.SortOrder.LayoutOrder
    
    return frame
end

local function updatePlayerList()
    print("Updating player list")
    local frame = createUI()
    for _, child in ipairs(frame:GetChildren()) do
        if child:IsA("TextLabel") then
            child:Destroy()
        end
    end

    for _, player in ipairs(Players:GetPlayers()) do
        print("Adding player:", player.Name)
        local textColor = Color3.fromRGB(255, 255, 255)
        if specialUsers[player.Name] then
            textColor = Color3.fromRGB(128, 0, 128)
        elseif anotherRoleUsers[player.Name] then
            textColor = Color3.fromRGB(0, 0, 255)
        end

        local playerLabel = Instance.new("TextLabel")
        playerLabel.Size = UDim2.new(1, 0, 0, 25)
        playerLabel.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
        playerLabel.TextColor3 = textColor
        playerLabel.Text = player.Name
        playerLabel.Parent = frame
    end
end

local function onCharacterAdded()
    print("Character added, updating UI")
    updatePlayerList()
end

local player = Players.LocalPlayer
player.CharacterAdded:Connect(onCharacterAdded)

updatePlayerList()

Players.PlayerAdded:Connect(function(newPlayer)
    print("Player joined:", newPlayer.Name)
    updatePlayerList()
end)

Players.PlayerRemoving:Connect(function(leavingPlayer)
    print("Player left:", leavingPlayer.Name)
    updatePlayerList()
end)
